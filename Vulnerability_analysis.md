Анализ уязвимостей данных выполнен с помощью статического анализатора уязвимостей кода Snyk (https://snyk.io).

Snyk — коммерческий инструмент для обнаружения, исправления и предотвращения известных уязвимостей в приложениях на JavaScript, Java и Ruby и других языков.
Snyk использует семантический анализ для обнаружения ошибок безопасности и производительности.\
С каждой обнаруженной уязвимостью с помощью Snyk можно получить подробное объяснение проблемы, потока данных, а также анализ исправления и способов предотвращения её (проблемы) в будущем.\
Кроме того, каждая уязвимость получает классификатор серьёзности (северити).

Исследуемый объект: https://github.com/ABenThabet/Raspi-Security представляет из себя умную систему дверного звонка на основе распознавания лиц для raspberry pi для отслеживания и информирования владельца о посетителях.\
Ниже представлены только уязвимости с высоким уровнем опасности: 

__1.	Path Traversal - Обход пути__
Unsanitized input from an HTTP header flows into file_put_contents, where it is used as a path. This may result in a Path Traversal vulnerability and allow an attacker to write to arbitrary files - Не Обработанный ввод из HTTP-заголовка поступает в file_put_contents, где он используется в качестве пути. Это может привести к уязвимости обхода пути и позволить злоумышленнику выполнять запись в произвольные файлы.
‎Ниже представлены места обнаружения данной уязвимости.
 
 ![Image alt](https://github.com/Yusupova1007/IOT/blob/main/images/1.1.jpg)
![Image alt](https://github.com/Yusupova1007/IOT/blob/main/images/1.2.jpg)
  ![Image alt](https://github.com/Yusupova1007/IOT/blob/main/images/1.3.jpg)
  ![Image alt](https://github.com/Yusupova1007/IOT/blob/main/images/1.4.jpg)
  ![Image alt](https://github.com/Yusupova1007/IOT/blob/main/images/1.5.jpg)
   ![Image alt](https://github.com/Yusupova1007/IOT/blob/main/images/1.6.jpg)


Unsanitized input from an uploaded file flows into move_uploaded_file, where it is used as a path. This may result in a Path Traversal vulnerability and allow an attacker to move arbitrary files. - Не Обработанный ввод из загруженного файла поступает в move_uploaded_file, где он используется в качестве пути. Это может привести к уязвимости обхода пути и позволить злоумышленнику перемещать произвольные файлы.
  ![Image alt](https://github.com/Yusupova1007/IOT/blob/main/images/1.7.jpg)

Подробности\
Атака с обходом каталогов (также известная как обход пути) направлена на доступ к файлам и каталогам, которые хранятся за пределами предполагаемой папки. Манипулируя файлами с помощью последовательностей "точка-многоточие-косая черта (../)" и их вариаций или используя абсолютные пути к файлам, может оказаться возможным получить доступ к произвольным файлам и каталогам, хранящимся в файловой системе, включая исходный код приложения, конфигурацию и другие важные системные файлы.

Возможность доступа к произвольному пути и манипулирования им приводит к уязвимостям, когда программа запускается с привилегиями, которых не должно быть у пользователя, предоставляющего путь. Веб-сайт с уязвимостью обхода пути позволил бы пользователям получить доступ к конфиденциальным файлам на сервере, на котором он размещен. Программы CLI также могут быть уязвимы для обхода пути, если они запускаются с повышенными привилегиями (например, с флагами setuid или setgid в системах Unix).

Уязвимости при обходе каталогов в целом можно разделить на два типа:\
Information Disclosure (Раскрытие информации): позволяет злоумышленнику получить информацию о структуре папок или прочитать содержимое конфиденциальных файлов в системе.\
Writing arbitrary files (Запись произвольных файлов): позволяет злоумышленнику создавать или заменять существующие файлы. Этот тип уязвимости также известен как Zip-Slip.

Один из способов добиться этого - использовать вредоносный zip-архив, содержащий имена файлов для обхода пути. Когда каждое имя файла в zip-архиве объединяется с целевой папкой извлечения без проверки, конечный путь оказывается за пределами целевой папки. Если исполняемый файл или файл конфигурации перезаписан файлом, содержащим вредоносный код, проблема может довольно легко превратиться в проблему с выполнением произвольного кода.

__2.	Command Injection (Ввод команды)__\
Unsanitized input from an HTTP parameter flows into system, where it is used to build a shell command. This may result in a Command Injection vulnerability. - Не Обработанный ввод из параметра HTTP поступает в систему, где он используется для создания команды оболочки. Это может привести к уязвимости при внедрении команд.
Ниже представлены места обнаружения данной уязвимости.\
  ![Image alt](https://github.com/Yusupova1007/IOT/blob/main/images/2.1.jpg)
‎ ![Image alt](https://github.com/Yusupova1007/IOT/blob/main/images/2.2.jpg)
 ![Image alt](https://github.com/Yusupova1007/IOT/blob/main/images/2.3.jpg)
 ![Image alt](https://github.com/Yusupova1007/IOT/blob/main/images/2.4.jpg)
 
Подробности\
С помощью атаки с внедрением команд операционной системы пользователь веб-приложения может передавать команды непосредственно в системную оболочку, прикрепленные к законному запросу. Затем эти команды могут быть выполнены на сервере приложений, что потенциально может привести к вредным последствиям, включая раскрытие или удаление данных. Как и атаки с внедрением кода, атаки с внедрением команд, по сути, представляют собой сбой проверки данных. В отличие от атак с внедрением кода, которые вводят новый код, атаки с внедрением команд используют существующие системные функции, часто используя неоправданно высокий уровень привилегий приложения, увеличивая риск серьезного вреда и ущерба репутации.

Наилучшие методы профилактики:\
-никогда не доверяйте пользовательскому вводу. Предположим, что любой ввод может передавать вредные значения,
-примите принцип наименьших привилегий: ни одно приложение не должно иметь более высокого уровня доступа, чем это необходимо для выполнения требуемых задач,
-управляйте политиками доступа пользователей на основе каждой отдельной задачи,
-не передавайте пользовательский ввод непосредственно в систему; используйте библиотеки или API, у которых отсутствует доступ к системе,
-там, где должны передаваться команды оболочки, экранируйте значения с помощью таких функций, как shlex для Python или escapeshellarg() для PHP,
-обработайте пользовательский ввод с помощью регулярных выражений, чтобы определить разрешенные символы наряду с максимальной длиной строки,
-преобразуйте специальные символы, такие как & | ; $ > < \ !, перед передачей на сервер,
-внесите разрешенные команды в белый список и проверьте ответы пользователей на соответствие этим ожиданиям,
-помните, что внедрение кода может осуществляться по нескольким направлениям: запросы GET и POST, а также файлы cookie и HTTP-заголовки,
-обеспечьте своевременное внесение исправлений во все системы для устранения известных уязвимостей,
-обучите всех членов команды более безопасным процедурам обработки данных для предотвращения атак.

__3.	SQL Injection (SQL-инъекция)__\
Unsanitized input from an HTTP parameter flows into mysql_query, where it is used in an SQL query. This may result in an SQL Injection vulnerability. - Не Обработанный ввод из HTTP-параметра поступает в mysql_query, где он используется в SQL-запросе. Это может привести к уязвимости SQL-инъекции.
Ниже представлены места обнаружения данной уязвимости.\
 ![Image alt](https://github.com/Yusupova1007/IOT/blob/main/images/3.1.jpg)
 ![Image alt](https://github.com/Yusupova1007/IOT/blob/main/images/3.2.jpg)
 ![Image alt](https://github.com/Yusupova1007/IOT/blob/main/images/3.3.jpg)
 ![Image alt](https://github.com/Yusupova1007/IOT/blob/main/images/3.4.jpg)

Подробности\
При атаке с использованием SQL-инъекции пользователь может отправить SQL-запрос непосредственно в базу данных, получив доступ без предоставления соответствующих учетных данных. Затем злоумышленники могут просматривать, экспортировать, изменять и удалять конфиденциальную информацию; изменять пароли и другую аутентификационную информацию; и, возможно, получать доступ к другим системам в сети. Это одна из наиболее часто используемых категорий уязвимостей, но е` в значительной степени можно избежать с помощью надлежащей практики кодирования.

Наилучшие методы профилактики:\
-избегайте передачи введённых пользователем параметров непосредственно на SQL-сервер,
-избегайте использования конкатенации строк для построения SQL-запросов на основе введённых пользователем параметров,
-при кодировании сначала определите SQL-код, а затем передайте параметры. Используйте подготовленные инструкции с параметризованными запросами. Примерами могут служить SqlCommand() в .NET и bindParam() в PHP,
-используйте строгую типизацию для всех параметров, чтобы неожиданные пользовательские данные были отклонены,
-там, где прямого пользовательского ввода невозможно избежать по соображениям производительности, проверяйте ввод по очень строгому списку разрешенных символов, избегая специальных символов, таких как ? & / < > ; - ' " \ и пробелы. По возможности используйте процедуру экранирования, поставляемую поставщиком,
-разрабатывайте своёё приложение в среде и/или с использованием библиотек, которые обеспечивают защиту от SQL-инъекций,
-упростите всю свою среду на основе модели с наименьшими привилегиями, в идеале с изолированными учётными записями, имеющими привилегии только для определенных задач.

__4.	Regular Expression Denial of Service (ReDoS) - Отказ в обслуживании с помощью регулярных выражений (повторы)__\
Unsanitized user input from an HTTP header flows into preg_match, where it is used to build a regular expression. This may result in a Regular expression Denial of Service attack (reDOS). - Не Обработанный пользовательский ввод из HTTP-заголовка поступает в preg_match, где он используется для построения регулярного выражения. Это может привести к атаке отказа в обслуживании с помощью регулярных выражений (dos).\
Ниже представлены места обнаружения данной уязвимости.\
 ![Image alt](https://github.com/Yusupova1007/IOT/blob/main/images/4.1.jpg)
 ![Image alt](https://github.com/Yusupova1007/IOT/blob/main/images/4.2.jpg)
 ![Image alt](https://github.com/Yusupova1007/IOT/blob/main/images/4.3.jpg)

Подробности\
Отказ в обслуживании (DoS) описывает семейство атак, все из которых направлены на то, чтобы сделать систему недоступной для её первоначальных и законных пользователей. Существует много типов DoS-атак, начиная от попыток заблокировать сетевые каналы, ведущие к системе, путем генерации большого объема трафика со многих компьютеров (распределенный отказ в обслуживании - DDoS - атака) и заканчивая отправкой обработанных запросов, которые приводят к сбою системы или занимают непропорционально много времени на обработку.

Отказ в обслуживании с помощью регулярных выражений (ReDoS) — это тип атаки типа "Отказ в обслуживании". Регулярные выражения невероятно мощны, но они не очень интуитивно понятны и в конечном итоге могут облегчить злоумышленникам доступ к вашему сайту.

__5.	Server-Side Request Forgery (SSRF) - Подделка запросов на стороне сервера (SSRF)__\
Unsanitized input from an HTTP header flows into unlink, where it is used as an URL to perform a request. This may result in a Server-Side Request Forgery vulnerability. - Не Обработанный ввод из HTTP-заголовка поступает в unlink, где он используется в качестве URL-адреса для выполнения запроса. Это может привести к уязвимости для подделки запросов на стороне сервера.\
Ниже представлены места обнаружения данной уязвимости.\
 ![Image alt](https://github.com/Yusupova1007/IOT/blob/main/images/5.1.jpg)
  ![Image alt](https://github.com/Yusupova1007/IOT/blob/main/images/5.2.jpg)
  ![Image alt](https://github.com/Yusupova1007/IOT/blob/main/images/5.3.jpg)

Подробности\
При атаке на подделку запросов на стороне сервера злоумышленник отправляет URL-адрес (внешний URL-адрес или сетевой IP-адрес, такой как 127.0.0.1) серверной части приложения. Затем сервер получает доступ к URL-адресу и делится с злоумышленником результатами, которые могут включать конфиденциальную информацию, такую как метаданные AWS, информация о внутренней конфигурации или содержимое базы данных. Поскольку запрос поступает из серверной части, он обходит средства контроля доступа, потенциально раскрывая информацию, для получения которой у пользователя недостаточно привилегий. Затем злоумышленник может воспользоваться этой информацией, чтобы получить доступ, модифицировать веб-приложение или потребовать выкуп.

Наилучшие методы профилактики:\
-чёрные списки проблематичны, и у злоумышленников есть множество способов обойти их; в идеале используйте белый список всех разрешенных доменов и IP-адресов,
-используйте аутентификацию даже в вашей собственной сети, чтобы предотвратить использование запросов на стороне сервера,
-внедрите нулевое доверие и очистите и подтвердите все данные URL и заголовка, возвращаемые на сервер от пользователя. Удалите недопустимые или подозрительные символы, затем проверьте, чтобы убедиться, что они содержат допустимое и ожидаемое значение,
-в идеале вообще избегайте отправки запросов к серверу на основе предоставленных пользователем данных,
-убедитесь, что вы не отправляете необработанные тела ответов с сервера непосредственно клиенту. Предоставляйте только ожидаемые ответы,
-отключите подозрительные и уязвимые схемы URL-адресов. Распространенными виновниками являются неясные и малоиспользуемые схемы, такие как file://, dict://, ftp:// и gopher://.

__6.	Cross-site Scripting (XSS) - Межсайтовый скриптинг (XSS)__\
Unsanitized input from an HTTP header flows into the echo statement, where it is used to render an HTML page returned to the user. This may result in a Cross-Site Scripting attack (XSS). - Не Обработанный ввод из HTTP-заголовка поступает в инструкцию echo, где он используется для отображения HTML-страницы, возвращаемой пользователю. Это может привести к межсайтовой скриптовой атаке (XSS).\
Ниже представлено место обнаружения данной уязвимости.\
  ![Image alt](https://github.com/Yusupova1007/IOT/blob/main/images/6.jpg)

Подробности\
Атака с использованием межсайтовых сценариев происходит, когда злоумышленник обманывает законное веб-приложение или сайт, чтобы они приняли запрос как исходящий из надежного источника.

Это делается путём выхода из контекста веб-приложения; затем веб-приложение доставляет эти данные своим пользователям вместе с другим надёжным динамическим контентом без его проверки. Браузер неосознанно запускает вредоносный скрипт на стороне клиента (с помощью клиентских языков; обычно JavaScript или HTML) для выполнения действий, которые в противном случае обычно блокируются той же политикой происхождения браузера.\
Внедрение вредоносного кода является наиболее распространенным способом использования XSS; по этой причине экранирование символов для предотвращения подобных манипуляций является лучшим методом защиты кода от этой уязвимости.

Экранирование означает, что приложение закодировано для обозначения ключевых символов, и в частности ключевых символов, включенных в пользовательский ввод, чтобы предотвратить интерпретацию этих символов в опасном контексте. Например, в HTML < может быть закодирован как &lt; и > может быть закодирован как &gt; для того, чтобы интерпретироваться и отображаться как они сами по себе в тексте, в то время как в самом коде они используются для HTML-тегов. Если вредоносный контент вводится в приложение, которое экранирует специальные символы, и это вредоносное содержимое использует < и > в качестве HTML-тегов, эти символы, тем не менее, не интерпретируются браузером как HTML-теги, если они были правильно экранированы в коде приложения, и таким образом попытка атаки отклоняется.

Наиболее распространенным применением XSS является кража файлов cookie и перехват пользовательских сеансов, но эксплойты XSS использовались для раскрытия конфиденциальной информации, обеспечения доступа к привилегированным сервисам и функциональным возможностям и доставки вредоносных программ.

Ниже описаны основные рекомендации, разработанные специально для защиты кода:\
-обработайте вводимые данные в HTTP-запросе перед их отражением обратно, убедившись, что все данные проверены, отфильтрованы или экранированы, прежде чем отправлять что-либо обратно пользователю, например значения параметров запроса во время поиска.
-преобразуйте специальные символы, такие как ?, &, /, <, > и пробелы, в их соответствующие эквиваленты в кодировке HTML или URL,
-предоставьте пользователям возможность отключать клиентские скрипты,
-перенаправлять недопустимые запросы,
-обнаруживать одновременные входы в систему, в том числе с двух разных IP-адресов, и аннулировать эти сеансы,
-используйте и применяйте политику безопасности контента, чтобы отключить любые функции, которыми можно манипулировать для атаки XSS.
-прочтите документацию по любой из библиотек, на которые ссылается ваш код, чтобы понять, какие элементы допускают встроенный HTML.

Кроме того, в проекте обнаружены уязвимости со среднем уровнем опасности (48 шт., которые включают Use of Hardcoded Credentials, Debug Mode Enabled, Open Redirect, Cleartext Transmission of Sensitive Information, Path Traversal, Cross-site Scripting (XSS)) и с низким уровнем опасности (22 шт., которые включают Use of Hardcoded Credentials, Python 2 source code).
